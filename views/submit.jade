extends layouts/main

block content
  if (locals.errors.length)
    .errors
      each msg in errors
        div= msg
  form(method='POST')
    .row
      .col2
        input(name='name', type='text', placeholder='Essay Title', value=(essay && essay.name), autofocus, required)
      .col2
        select.select2(name='college', data-placeholder='Which university is this essay for?')
          option
          each college in colleges
            option(value='#{ college.slug }' selected=(essay && (essay.college === college.slug)))= college.name
    .row
      .ghost
          #editor-toolbar.toolbar.clearfix(style='display: none;')
            a(data-wysihtml5-command='bold'): i.icon-bold
            a(data-wysihtml5-command='italic'): i.icon-italic
            a(data-wysihtml5-command='underline'): i.icon-underline
            a(data-wysihtml5-command='formatBlock', data-wysihtml5-command-value='h2') Heading
    .row
      textarea#editor(name='body', placeholder='Paste your essay here...')
    .row
      button.btn.large(type='submit') Submit Essay

append stylesheets
  link(rel='stylesheet', href='/out/bower_components/select2/select2.css')

append scripts
  script(src='/out/bower_components/wysihtml5/parser_rules/advanced.js')
  script(src='/out/bower_components/wysihtml5/dist/wysihtml5-0.4.0pre.min.js')
  script(src='/out/bower_components/wysihtml5_size_matters/jquery.wysihtml5_size_matters.js')
  script(src='/out/bower_components/select2/select2.min.js')
  script.
    var editor = new wysihtml5.Editor('editor', {
      toolbar: 'editor-toolbar',
      autoLink: false, // Don't auto-link URLs
      stylesheets: ['/css/editor.css'], // Iframe editor stylesheets
      parserRules: wysihtml5ParserRules, // Rules to parse copy & pasted html
      useLineBreaks: false, // Use <p> instead of <br> for line breaks
      cleanUp: true // remove senseless <span> elements (empty or w/o attrs)
    })

    // Auto-resize editor
    editor.on('load', function() {
      $(editor.composer.iframe).wysihtml5_size_matters()
    })

    $('.select2').select2()